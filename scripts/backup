#!/bin/bash
#=================================================
# YunoHost backup script for Atuin server
#=================================================

source /usr/share/yunohost/helpers

app="${YNH_APP_INSTANCE_NAME:-atuin}"

#=================================================
# LOAD SETTINGS / RESOURCES
#=================================================
: "${install_dir:?install_dir is required}"
: "${data_dir:?data_dir is required}"

#=================================================
# BACKUP (declarative)
#=================================================
ynh_print_info "Declaring files to be backed up for $app..."

# Atuin is installed into $install_dir (provisioned by the install_dir resource),
# and stores runtime data/config in $data_dir (provisioned by the data_dir resource).

# App binary / installed files
ynh_backup --src_path="$install_dir"

# App data (SQLite DB, server.toml, env, etc.)
ynh_backup --src_path="$data_dir"

# Optional: if your app creates additional system configs explicitly and you want them in backups,
# declare them here. Otherwise prefer to regenerate them in restore (systemd/nginx are re-rendered there).

ynh_print_info "Backup declaration done."

