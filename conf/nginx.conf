#sub_path_only rewrite ^__PATH__$ __PATH__/ permanent;
location __PATH__/ {
    proxy_pass http://127.0.0.1:__PORT__/;

    # Use YunoHost standardized reverse-proxy params (YunoHost >= 12.1.38)
    include proxy_params_no_auth;

    # Atuin client uses Authorization header (Bearer token) for sync
    proxy_set_header Authorization $http_authorization;

    # Prevent proxy buffering issues for APIs/streaming (safe default)
    proxy_buffering off;

    # Reasonable timeouts for sync operations
    proxy_connect_timeout 60s;
    proxy_send_timeout 600s;
    proxy_read_timeout 600s;
}
